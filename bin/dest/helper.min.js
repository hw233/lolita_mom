var helper;!function(helper){helper.do_test=function(data_arr){"closestat"==data_arr[0]&&Laya.Stat.hide()}}(helper||(helper={})),function(helper){function createSpanTag(color,fSize){return'<span style="color:'+color+"; font-size:"+fSize+'px;">'}function createLinkTag(color,fSize,urlData,info){return'<span href="'+urlData+'" style="color:'+color+"; font-size:"+fSize+'px;">'+info+"</span>"+helper.createSpanTag(color,fSize)}function createImgTag(imgUrl){return'<img src="'+imgUrl+'"/>'}helper.create_format_link=function(text,htype,u1,u2,u3,color){void 0===color&&(color="#C18&"),255<text.length&&(text=text.substr(0,255));var len=text.length.toString(16);return text.length<16?color+"#H&l0"+len+"("+text+","+htype+","+u1+","+u2+","+u3+")#D&":color+"#H&l"+len+"("+text+","+htype+","+u1+","+u2+","+u3+")#D&"},helper.trans_info=function(info){for(var temp=info,markAb="",tempArr=temp.split("#"),markAbArr=[],i=0;i<tempArr.length;i++)tempArr[i]="#"+tempArr[i],tempArr[i].match(/#\d{1,3}/)&&(markAb=tempArr[i].match(/#\d{1,3}/)[0],markAbArr.push(markAb));var ele="";for(i=0;i<markAbArr.length;i++)ele=markAbArr[i],base.FORMAT_EMOTION[ele]||(markAbArr[i]=ele.substr(0,ele.length-1),ele=markAbArr[i],base.FORMAT_EMOTION[ele]||(markAbArr[i]=ele.substr(0,ele.length-1),ele=markAbArr[i]));return markAbArr.forEach(function(element){temp.match(element)&&(temp=temp.replace(element,base.FORMAT_EMOTION[element]))}),core.game_tiplog(temp),temp},helper.analysisMsgStr=function(msgString,dColor,dFSize){void 0===dColor&&(dColor="#FACD89"),void 0===dFSize&&(dFSize="44");for(var data=msgString,htmlStr="",curColor=dColor,curFSize=dFSize,curStyleStr="",inEdit=!1,isOpen=!1,temp="",index=0,isFont=!1,cur_str="",isColor=!1,isHlink=isFont=!1,isPic=!1,isEmoji=!1,isFEnd=!1,isCEnd=!1,i=0;i<data.length;i++){if("#"==data[i]){if(!data[i+1]){htmlStr+=data[i];continue}if("C"==data[i+1])for(index=i+2,temp=data[i]+data[i+1];index<data.length;index++){if("&"==(cur_str=data[index])&&temp[temp.length-1].match(/\d/)){curStyleStr=temp+=cur_str,isColor=inEdit=!(temp=""),i=index;break}if(!cur_str.match(/\d/)){temp="";break}temp+=cur_str}else if("F"==data[i+1])for(index=i+2,temp=data[i]+data[i+1];index<data.length;index++){if("&"==(cur_str=data[index])&&temp[temp.length-1].match(/\d/)){curStyleStr=temp+=cur_str,isFont=inEdit=!(temp=""),i=index;break}if("D"==cur_str)temp+=cur_str;else{if("&"==cur_str&&"D"==temp[temp.length-1]){curStyleStr=temp+=cur_str,isFEnd=inEdit=!(temp=""),i=index;break}if(!cur_str.match(/\d/)){temp="";break}temp+=cur_str}}else if("H"==data[i+1])data[i+2]&&data[i+3]&&data[i+4]&&data[i+5]&&"&"==data[i+2]&&"l"==data[i+3]&&data[i+4].match(/[0-9a-fA-F]/)&&data[i+5].match(/[0-9a-fA-F]/)&&(curStyleStr=data[i]+data[i+1]+data[i+2]+data[i+3]+data[i+4]+data[i+5],isHlink=inEdit=!0,i+=5);else if("P"==data[i+1])for(index=i+2,temp=data[i]+data[i+1];index<data.length;index++){if("&"==(cur_str=data[index])&&temp[temp.length-1].match(/\d/)){curStyleStr=temp+=cur_str,isPic=inEdit=!(temp=""),i=index;break}if(!cur_str.match(/\d/)){temp="";break}temp+=cur_str}else if("E"==data[i+1])for(index=i+2,temp=data[i]+data[i+1];index<data.length;index++){if("&"==(cur_str=data[index])&&temp[temp.length-1].match(/\d/)){curStyleStr=temp+=cur_str,isEmoji=inEdit=!(temp=""),i=index;break}if(!cur_str.match(/\d/)){temp="";break}temp+=cur_str}else"D"==data[i+1]&&"&"==data[i+2]?(inEdit=isCEnd=!0,i+=2):"F"==data[i+1]&&"D"==data[i+2]&&"&"==data[i+3]&&(isFEnd=inEdit=!0,i+=3)}if(inEdit)if(isColor)isColor=!1,isOpen&&(htmlStr+="</span>",isOpen=!1),htmlStr+=createSpanTag(curColor=base.FORMAT_COLOR[curStyleStr],curFSize),inEdit=!(isOpen=!(curStyleStr=""));else if(isFont)isFont=!1,isOpen&&(htmlStr+="</span>",isOpen=!1),htmlStr+=createSpanTag(curColor,curFSize=base.FORMAT_FONT[curStyleStr]),inEdit=!(isOpen=!(curStyleStr=""));else if(isHlink){isHlink=!1;for(var j=i+1;j<data.length&&"("!=data[j];j++)curStyleStr+=data[j];for(var tagInfo,nameLen=curStyleStr.replace("#H&l",""),nameLenNum=parseInt(nameLen,16),urlData="",k=j+1;k<data.length;k++)if("&"==data[k]?urlData+="&amp;":"<"==data[k]?urlData+="&lt;":" "==data[k]?urlData+="&nbsp;":">"==data[k]?urlData+="&gt;":urlData+=data[k],")"==data[k]){if(urlData.length<=nameLenNum+2)continue;urlData=urlData.substr(0,urlData.length-1);break}var arr=urlData.split(",");tagInfo=arr[0],arr.splice(0,1),i=k,isOpen&&(htmlStr+="</span>",isOpen=!1),htmlStr+=createLinkTag(curColor,curFSize,urlData=tagInfo+","+arr.toString(),tagInfo),inEdit=!(isOpen=!(curStyleStr=""))}else isPic?(isOpen&&(htmlStr+="</span>",isOpen=!1),htmlStr+=createImgTag(base.SET_PICTURE_URL[curStyleStr]),isPic=inEdit=!1,curStyleStr=""):isEmoji?(isOpen&&(htmlStr+="</span>",isOpen=!1),htmlStr+=createImgTag(base.SET_EMOTION_URL[curStyleStr]),isEmoji=inEdit=!1,curStyleStr=""):isFEnd?(curFSize=dFSize,isOpen&&(htmlStr+="</span>",isOpen=!1),curStyleStr="",inEdit=!1):isCEnd&&(curColor=dColor,isOpen&&(htmlStr+="</span>",isOpen=!1),curStyleStr="",inEdit=!1);else"&"==data[i]?htmlStr+="&amp;":" "==data[i]?htmlStr+="&nbsp;":"<"==data[i]?htmlStr+="&lt;":">"==data[i]?htmlStr+="&gt;":htmlStr+=data[i]}return isOpen&&(htmlStr+="</span>"),htmlStr},helper.createSpanTag=createSpanTag,helper.createLinkTag=createLinkTag,helper.createImgTag=createImgTag}(helper||(helper={})),function(helper){helper.get_cur_milltime=function(){return laya.utils.Browser.now()},helper.get_cur_secstime=function(){return Math.round(laya.utils.Browser.now()/1e3)},helper.get_random_int=function(min,max){var min_int=Math.floor(min),max_int=Math.floor(max),radio=Math.random();return Math.floor(min_int+(max_int-min_int)*radio)},helper.convert_time_2_arr=function(secs){if(secs<=0)return[0,0,0,0];var time_list=new Array,value=0,result=0;return value=secs/86400,result=parseInt(value.toString()),time_list.push(result),value=(secs-=86400*result)/3600,result=parseInt(value.toString()),time_list.push(result),value=(secs-=3600*result)/60,result=parseInt(value.toString()),time_list.push(result),secs-=60*result,result=parseInt(secs.toString()),time_list.push(result),time_list},helper.convert_time_2_fotmatStr=function(secs){if(secs<=0)return"";var time_list=this.convert_time_2_arr(secs),day=time_list[0],hour=time_list[1],minu=time_list[2],sec=time_list[3],str="";return 0<day&&(str+=day.toString()+game.L_TIAN),(0<hour||0<day)&&(str+=hour.toString()+game.L_XIAOSHI),str+=minu.toString()+game.L_FEN+sec.toString()+game.L_MIAO},helper.format_timestamp_2_arr=function(timestamp){var date_arr=new Array,date=new Date(1e3*timestamp);return date_arr.push(date.getFullYear()),date_arr.push(date.getMonth()+1),date_arr.push(date.getDate()),date_arr.push(date.getHours()),date_arr.push(date.getMinutes()),date_arr.push(date.getSeconds()),date_arr},helper.format_timestamp_2_str=function(timestamp){var time_arr=this.format_timestamp_2_arr(timestamp),time_str="";return time_str+=time_arr[0].toString(),time_str+="-",time_str+=time_arr[1].toString(),time_str+="-",time_str+=time_arr[2].toString(),time_str+=" ",time_str+=10<=time_arr[3]?time_arr[3].toString():"0"+time_arr[3].toString(),time_str+=":",time_str+=10<=time_arr[4]?time_arr[4].toString():"0"+time_arr[4].toString(),time_str+=":",time_str+=10<=time_arr[5]?time_arr[5].toString():"0"+time_arr[5].toString()},helper.center_widget=function(m_ui,delay_x,delay_y){if(void 0===delay_x&&(delay_x=0),void 0===delay_y&&(delay_y=75),m_ui){var d_w=Laya.stage.designWidth,d_h=Laya.stage.designHeight;m_ui.x=(d_w-m_ui.width)/2-delay_x,m_ui.y=(d_h-m_ui.height)/2-delay_y}},helper.add_widget_hitArea=function(m_ui){if(m_ui){var d_w=Laya.stage.designWidth,d_h=Laya.stage.designHeight,graphics=new Laya.Graphics;graphics.save(),graphics.alpha(.5),graphics.drawRect(-m_ui.x,-m_ui.y,d_w,d_h,"#000000"),graphics.restore(),m_ui.graphics=graphics,m_ui.hitArea=new Laya.Rectangle(-m_ui.x,-m_ui.y,d_w,d_h)}},helper.remove_widget_hitArea=function(m_ui){m_ui&&(m_ui.graphics=null,m_ui.hitArea=null)},helper.is_arrays_equal=function(arr1,arr2){if(null==arr1||null==arr2)return!1;if(arr1.length!=arr2.length)return!1;for(var i=0;i<arr1.length;i++)if(arr1[i]!==arr2[i])return!1;return!0},helper.is_dict_equal=function(dict1,dict2){if(null==dict1||null==dict2)return!1;if(dict1.keys.length!=dict2.keys.length)return!1;for(var _i=0,_a=dict1.keys;_i<_a.length;_i++){var key=_a[_i];if(dict1.get(key)!=dict2.get(key))return!1}return!0},helper.format_number=function(value,b_odd){if(void 0===b_odd&&(b_odd=!0),value<=1)return b_odd?"":value.toString();if(1<value&&value<1e5)return value.toString();var num_str=value.toString(),wan_str="",one_str="",unit_str=game.L_WAN;if(1e5<=value&&value<1e6)wan_str=num_str.slice(0,2),one_str=num_str.slice(2,4);else if(1e6<=value&&value<1e7)wan_str=num_str.slice(0,3),one_str=num_str.slice(3,5);else if(1e7<=value&&value<1e8)wan_str=num_str.slice(0,4),one_str=num_str.slice(4,5);else if(1e8<=value&&value<1e9)wan_str=num_str.slice(0,1),one_str=num_str.slice(1,4),unit_str=game.L_YI;else if(1e9<=value&&value<1e10)wan_str=num_str.slice(0,2),one_str=num_str.slice(2,5),unit_str=game.L_YI;else{if(!(1e10<=value&&value<1e11))return Math.floor(value/1e8).toString()+game.L_YI;wan_str=num_str.slice(0,3),one_str=num_str.slice(3,5),unit_str=game.L_YI}for(;0<one_str.length&&"0"==one_str.slice(-1);)one_str=one_str.substring(0,one_str.length-1);return 0<one_str.length?wan_str+"."+one_str+unit_str:wan_str+unit_str},helper.show_text_tips=function(text){game.get_module(module_enum.MODULE_TIPS).show_tips({text:text})},helper.show_float_text_tips=function(text,x,y){utils.widget_ins().show_widget(widget_enum.WIDGET_TEXTTIPS,!0,[text,x,y,!1])},helper.show_center_text_tips=function(text){utils.widget_ins().show_widget(widget_enum.WIDGET_TEXTTIPS,!0,[text,0,0,!0])},helper.hide_float_text_tips=function(){utils.widget_ins().show_widget(widget_enum.WIDGET_TEXTTIPS,!1)},helper.show_format_text_tips=function(f_text){var text=helper.analysisMsgStr(f_text);game.get_module(module_enum.MODULE_TIPS).show_tips({text:text})},helper.get_ColorCode_by_quality=function(quality,b_light){return void 0===b_light&&(b_light=!1),quality==base.QT_GRAY?"#C0&":quality==base.QT_GREEN?0==b_light?"#C1&":"#C18&":quality==base.QT_BLUE?0==b_light?"#C2&":"#C12&":quality==base.QT_PURPLE?0==b_light?"#C3&":"#C19&":quality==base.QT_GOLD?0==b_light?"#C4&":"#C15&":quality==base.QT_RED?0==b_light?"#C5&":"#C20&":"#C0&"},helper.show_msgbox=function(p_content){utils.module_ins().get_module(module_enum.MODULE_SYS_MSG).show_msgbox(p_content)},helper.show_choose_msgbox=function(p_caller,p_content,p_user_data,NoTips_keys){void 0===p_user_data&&(p_user_data=null),void 0===NoTips_keys&&(NoTips_keys=""),utils.module_ins().get_module(module_enum.MODULE_SYS_MSG).show_msg_box(p_caller,p_content,p_user_data,NoTips_keys)},helper.get_sex=function(shape){return shape%2==1?base.SEX_MALE:base.SEX_FEMALE},helper.get_role_head=function(shape){return shape==base.HUMAN_MALE?"ui/sys/head_gg.png":shape==base.HUMAN_FEMALE?"ui/sys/head_mm.png":""},helper.html_filter=function(str){return-1==str.indexOf("<")&&-1==str.indexOf(">")&&-1==str.indexOf("/")&&-1==str.indexOf("\\")&&-1==str.indexOf("&")},helper.get_local=function(key){return Laya.LocalStorage.getItem(key)},helper.set_local=function(key,v){return Laya.LocalStorage.setItem(key,v)}}(helper||(helper={}));